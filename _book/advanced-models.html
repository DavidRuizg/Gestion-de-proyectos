<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Advanced Models | Data Analysis in Software Engineering using R</title>
  <meta name="description" content="DASE Data Analysis in Software Engineering" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Advanced Models | Data Analysis in Software Engineering using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="DASE Data Analysis in Software Engineering" />
  <meta name="github-repo" content="danrodgar/DASE" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Advanced Models | Data Analysis in Software Engineering using R" />
  
  <meta name="twitter:description" content="DASE Data Analysis in Software Engineering" />
  

<meta name="author" content="Daniel Rodriguez and Javier Dolado" />


<meta name="date" content="2021-10-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="feature-selection-example.html"/>
<link rel="next" href="further-classification-models.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analysis in Software Engineering with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="part"><span><b>I Introduction to the R Language</b></span></li>
<li class="chapter" data-level="1" data-path="r-intro.html"><a href="r-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="r-intro.html"><a href="r-intro.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="r-intro.html"><a href="r-intro.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.2</b> R and RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="r-intro.html"><a href="r-intro.html#basic-data-types"><i class="fa fa-check"></i><b>1.3</b> Basic Data Types</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="r-intro.html"><a href="r-intro.html#mising-values"><i class="fa fa-check"></i><b>1.3.1</b> Mising values</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-intro.html"><a href="r-intro.html#vectors"><i class="fa fa-check"></i><b>1.4</b> Vectors</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="r-intro.html"><a href="r-intro.html#coercion-for-vectors"><i class="fa fa-check"></i><b>1.4.1</b> Coercion for vectors</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-intro.html"><a href="r-intro.html#vector-arithmetic"><i class="fa fa-check"></i><b>1.4.2</b> Vector arithmetic</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-intro.html"><a href="r-intro.html#arrays-and-matrices"><i class="fa fa-check"></i><b>1.5</b> Arrays and Matrices</a></li>
<li class="chapter" data-level="1.6" data-path="r-intro.html"><a href="r-intro.html#factors"><i class="fa fa-check"></i><b>1.6</b> Factors</a></li>
<li class="chapter" data-level="1.7" data-path="r-intro.html"><a href="r-intro.html#lists"><i class="fa fa-check"></i><b>1.7</b> Lists</a></li>
<li class="chapter" data-level="1.8" data-path="r-intro.html"><a href="r-intro.html#data-frames"><i class="fa fa-check"></i><b>1.8</b> Data frames</a></li>
<li class="chapter" data-level="1.9" data-path="r-intro.html"><a href="r-intro.html#r-functional-functions"><i class="fa fa-check"></i><b>1.9</b> R Functional Functions</a></li>
<li class="chapter" data-level="1.10" data-path="r-intro.html"><a href="r-intro.html#environments"><i class="fa fa-check"></i><b>1.10</b> Environments</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="r-intro.html"><a href="r-intro.html#global-variables-local-variables-and-programming-scope"><i class="fa fa-check"></i><b>1.10.1</b> Global variables, local variables and programming scope</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="r-intro.html"><a href="r-intro.html#reading-data"><i class="fa fa-check"></i><b>1.11</b> Reading Data</a></li>
<li class="chapter" data-level="1.12" data-path="r-intro.html"><a href="r-intro.html#plots"><i class="fa fa-check"></i><b>1.12</b> Plots</a></li>
<li class="chapter" data-level="1.13" data-path="r-intro.html"><a href="r-intro.html#control-flow-in-r"><i class="fa fa-check"></i><b>1.13</b> Control flow in R</a></li>
<li class="chapter" data-level="1.14" data-path="r-intro.html"><a href="r-intro.html#built-in-datasets"><i class="fa fa-check"></i><b>1.14</b> Built-in Datasets</a></li>
<li class="chapter" data-level="1.15" data-path="r-intro.html"><a href="r-intro.html#other-tools-with-r"><i class="fa fa-check"></i><b>1.15</b> Other tools with R</a>
<ul>
<li class="chapter" data-level="1.15.1" data-path="r-intro.html"><a href="r-intro.html#rattle"><i class="fa fa-check"></i><b>1.15.1</b> Rattle</a></li>
<li class="chapter" data-level="1.15.2" data-path="r-intro.html"><a href="r-intro.html#jamovi"><i class="fa fa-check"></i><b>1.15.2</b> Jamovi</a></li>
<li class="chapter" data-level="1.15.3" data-path="r-intro.html"><a href="r-intro.html#jasp"><i class="fa fa-check"></i><b>1.15.3</b> JASP</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Introduction to Data Mining</b></span></li>
<li class="chapter" data-level="2" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><i class="fa fa-check"></i><b>2</b> What is Data Mining / Knowledge Discovery in Databases (KDD)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#the-aim-of-data-analysis-and-statistical-learning"><i class="fa fa-check"></i><b>2.1</b> The Aim of Data Analysis and Statistical Learning</a></li>
<li class="chapter" data-level="2.2" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#data-science"><i class="fa fa-check"></i><b>2.2</b> Data Science</a></li>
<li class="chapter" data-level="2.3" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#some-references"><i class="fa fa-check"></i><b>2.3</b> Some References</a></li>
<li class="chapter" data-level="2.4" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#data-mining-and-data-science-with-r"><i class="fa fa-check"></i><b>2.4</b> Data Mining and Data Science with R</a></li>
<li class="chapter" data-level="2.5" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#data-mining-with-weka"><i class="fa fa-check"></i><b>2.5</b> Data Mining with Weka</a></li>
<li class="chapter" data-level="2.6" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#r-markdown"><i class="fa fa-check"></i><b>2.6</b> R Markdown</a></li>
<li class="chapter" data-level="2.7" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#including-plots"><i class="fa fa-check"></i><b>2.7</b> Including Plots</a></li>
<li class="chapter" data-level="2.8" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#references"><i class="fa fa-check"></i><b>2.8</b> References</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#prediction-in-probabilistic-classifiers"><i class="fa fa-check"></i><b>2.8.1</b> Prediction in probabilistic classifiers</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#other-metrics-used-in-software-engineering-with-classification"><i class="fa fa-check"></i><b>2.9</b> Other Metrics used in Software Engineering with Classification</a></li>
<li class="chapter" data-level="2.10" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#graphical-evaluation"><i class="fa fa-check"></i><b>2.10</b> Graphical Evaluation</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#receiver-operating-characteristic-roc"><i class="fa fa-check"></i><b>2.10.1</b> Receiver Operating Characteristic (ROC)</a></li>
<li class="chapter" data-level="2.10.2" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#precision-recall-curve-prc"><i class="fa fa-check"></i><b>2.10.2</b> Precision-Recall Curve (PRC)</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="what-is-data-mining-knowledge-discovery-in-databases-kdd.html"><a href="what-is-data-mining-knowledge-discovery-in-databases-kdd.html#numeric-prediction-evaluation"><i class="fa fa-check"></i><b>2.11</b> Numeric Prediction Evaluation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="evaluationSE.html"><a href="evaluationSE.html"><i class="fa fa-check"></i><b>3</b> Measures of Evaluation in Software Engineering</a>
<ul>
<li class="chapter" data-level="3.1" data-path="evaluationSE.html"><a href="evaluationSE.html#effort-estimation-evaluation-metrics"><i class="fa fa-check"></i><b>3.1</b> Effort estimation evaluation metrics</a></li>
<li class="chapter" data-level="3.2" data-path="evaluationSE.html"><a href="evaluationSE.html#evaluation-of-the-model-in-the-testing-data"><i class="fa fa-check"></i><b>3.2</b> Evaluation of the Model in the Testing data</a></li>
<li class="chapter" data-level="3.3" data-path="evaluationSE.html"><a href="evaluationSE.html#building-a-linear-model-on-the-telecom1-dataset"><i class="fa fa-check"></i><b>3.3</b> Building a Linear Model on the Telecom1 dataset</a></li>
<li class="chapter" data-level="3.4" data-path="evaluationSE.html"><a href="evaluationSE.html#building-a-linear-model-on-the-telecom1-dataset-with-all-observations"><i class="fa fa-check"></i><b>3.4</b> Building a Linear Model on the Telecom1 dataset with all observations</a></li>
<li class="chapter" data-level="3.5" data-path="evaluationSE.html"><a href="evaluationSE.html#standardised-accuracy-examples"><i class="fa fa-check"></i><b>3.5</b> Standardised Accuracy Examples</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="evaluationSE.html"><a href="evaluationSE.html#standardised-accuracy-marp0-using-the-china-test-dataset"><i class="fa fa-check"></i><b>3.5.1</b> Standardised Accuracy MARP0 using the China Test dataset</a></li>
<li class="chapter" data-level="3.5.2" data-path="evaluationSE.html"><a href="evaluationSE.html#standardised-accuracy.-marp0-using-the-telecom1-dataset"><i class="fa fa-check"></i><b>3.5.2</b> Standardised Accuracy. MARP0 using the Telecom1 dataset</a></li>
<li class="chapter" data-level="3.5.3" data-path="evaluationSE.html"><a href="evaluationSE.html#standard-accuracy-marp0-using-the-atkinson-dataset"><i class="fa fa-check"></i><b>3.5.3</b> Standard Accuracy MARP0 using the Atkinson Dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="evaluationSE.html"><a href="evaluationSE.html#exact-marp0"><i class="fa fa-check"></i><b>3.6</b> Exact MARP0</a></li>
<li class="chapter" data-level="3.7" data-path="evaluationSE.html"><a href="evaluationSE.html#computing-the-bootstraped-confidence-interval-of-the-mean-for-the-test-observations-of-the-china-dataset"><i class="fa fa-check"></i><b>3.7</b> Computing the bootstraped confidence interval of the mean for the Test observations of the China dataset:</a></li>
<li class="chapter" data-level="3.8" data-path="evaluationSE.html"><a href="evaluationSE.html#defect-prediction-evaluation-metrics"><i class="fa fa-check"></i><b>3.8</b> Defect prediction evaluation metrics</a></li>
</ul></li>
<li class="part"><span><b>III Advanced Topics</b></span></li>
<li class="chapter" data-level="4" data-path="feature-selection.html"><a href="feature-selection.html"><i class="fa fa-check"></i><b>4</b> Feature Selection</a>
<ul>
<li class="chapter" data-level="4.1" data-path="feature-selection.html"><a href="feature-selection.html#instance-selection"><i class="fa fa-check"></i><b>4.1</b> Instance Selection</a></li>
<li class="chapter" data-level="4.2" data-path="feature-selection.html"><a href="feature-selection.html#missing-data-imputation"><i class="fa fa-check"></i><b>4.2</b> Missing Data Imputation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="feature-selection-example.html"><a href="feature-selection-example.html"><i class="fa fa-check"></i><b>5</b> Feature Selection Example</a></li>
<li class="chapter" data-level="6" data-path="advanced-models.html"><a href="advanced-models.html"><i class="fa fa-check"></i><b>6</b> Advanced Models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="advanced-models.html"><a href="advanced-models.html#genetic-programming-for-symbolic-regression"><i class="fa fa-check"></i><b>6.1</b> Genetic Programming for Symbolic Regression</a></li>
<li class="chapter" data-level="6.2" data-path="advanced-models.html"><a href="advanced-models.html#genetic-programming-example"><i class="fa fa-check"></i><b>6.2</b> Genetic Programming Example</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="advanced-models.html"><a href="advanced-models.html#load-data"><i class="fa fa-check"></i><b>6.2.1</b> Load Data</a></li>
<li class="chapter" data-level="6.2.2" data-path="advanced-models.html"><a href="advanced-models.html#genetic-programming-for-symbolic-regression-china-dataset."><i class="fa fa-check"></i><b>6.2.2</b> Genetic Programming for Symbolic Regression: China dataset.</a></li>
<li class="chapter" data-level="6.2.3" data-path="advanced-models.html"><a href="advanced-models.html#genetic-programming-for-symbolic-regression.-telecom1-dataset."><i class="fa fa-check"></i><b>6.2.3</b> Genetic Programming for Symbolic Regression. Telecom1 dataset.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="advanced-models.html"><a href="advanced-models.html#neural-networks"><i class="fa fa-check"></i><b>6.3</b> Neural Networks</a></li>
<li class="chapter" data-level="6.4" data-path="advanced-models.html"><a href="advanced-models.html#support-vector-machines"><i class="fa fa-check"></i><b>6.4</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.5" data-path="advanced-models.html"><a href="advanced-models.html#ensembles"><i class="fa fa-check"></i><b>6.5</b> Ensembles</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="advanced-models.html"><a href="advanced-models.html#bagging"><i class="fa fa-check"></i><b>6.5.1</b> Bagging</a></li>
<li class="chapter" data-level="6.5.2" data-path="advanced-models.html"><a href="advanced-models.html#boosting"><i class="fa fa-check"></i><b>6.5.2</b> Boosting</a></li>
<li class="chapter" data-level="6.5.3" data-path="advanced-models.html"><a href="advanced-models.html#rotation-forests"><i class="fa fa-check"></i><b>6.5.3</b> Rotation Forests</a></li>
<li class="chapter" data-level="6.5.4" data-path="advanced-models.html"><a href="advanced-models.html#boosting-in-r"><i class="fa fa-check"></i><b>6.5.4</b> Boosting in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="further-classification-models.html"><a href="further-classification-models.html"><i class="fa fa-check"></i><b>7</b> Further Classification Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="further-classification-models.html"><a href="further-classification-models.html#multilabel-classification"><i class="fa fa-check"></i><b>7.1</b> Multilabel classification</a></li>
<li class="chapter" data-level="7.2" data-path="further-classification-models.html"><a href="further-classification-models.html#semi-supervised-learning"><i class="fa fa-check"></i><b>7.2</b> Semi-supervised Learning</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="social-network-analysis-in-se.html"><a href="social-network-analysis-in-se.html"><i class="fa fa-check"></i><b>8</b> Social Network Analysis in SE</a></li>
<li class="chapter" data-level="9" data-path="text-mining-software-engineering-data.html"><a href="text-mining-software-engineering-data.html"><i class="fa fa-check"></i><b>9</b> Text Mining Software Engineering Data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="text-mining-software-engineering-data.html"><a href="text-mining-software-engineering-data.html#terminology"><i class="fa fa-check"></i><b>9.1</b> Terminology</a></li>
<li class="chapter" data-level="9.2" data-path="text-mining-software-engineering-data.html"><a href="text-mining-software-engineering-data.html#example-of-classifying-bugs-from-bugzilla"><i class="fa fa-check"></i><b>9.2</b> Example of classifying bugs from Bugzilla</a></li>
<li class="chapter" data-level="9.3" data-path="text-mining-software-engineering-data.html"><a href="text-mining-software-engineering-data.html#extracting-data-from-twitter"><i class="fa fa-check"></i><b>9.3</b> Extracting data from Twitter</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>10</b> Time Series</a>
<ul>
<li class="chapter" data-level="10.1" data-path="time-series.html"><a href="time-series.html#web-tutorials-about-time-series"><i class="fa fa-check"></i><b>10.1</b> Web tutorials about Time Series:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis in Software Engineering using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="advanced-models" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Advanced Models</h1>
<div id="genetic-programming-for-symbolic-regression" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Genetic Programming for Symbolic Regression</h2>
<p>This technique is inspired by Darwin’s evolution theory.
+ 1960s by I. Rechenberg in his work “Evolution strategies“
+ 1975 Genetic Algorithms (GAs) invented by J Holland and published in his book”Adaption in Natural and Artificial Systems“
+ 1992 J. Koza has used genetic algorithm to evolve programs to perform certain tasks. He called his method “genetic programming”</p>
<p>Other reference for GP: Langdon WB, Poli R (2001) Foundations of Genetic Programming. Springer.</p>
<p><img src="figures/gpEvolution.png" /></p>
<ul>
<li>Depending on the function set used and the function to be minimised, GP can generate almost any type of curve</li>
</ul>
<p><img src="figures/gp1.png" />
<img src="figures/gp2.png" /></p>
<div class="figure">
<img src="figures/evoAlg.png" alt="" />
<p class="caption">Evolutionary Algorithms</p>
</div>
<p>In R, we can use the “rgp” package</p>
</div>
<div id="genetic-programming-example" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Genetic Programming Example</h2>
<div id="load-data" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Load Data</h3>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="advanced-models.html#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb462-2"><a href="advanced-models.html#cb462-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-3"><a href="advanced-models.html#cb462-3" aria-hidden="true" tabindex="-1"></a><span class="co">#read data</span></span>
<span id="cb462-4"><a href="advanced-models.html#cb462-4" aria-hidden="true" tabindex="-1"></a>telecom1 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;./datasets/effortEstimation/Telecom1.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>,<span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>, <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>) </span>
<span id="cb462-5"><a href="advanced-models.html#cb462-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb462-6"><a href="advanced-models.html#cb462-6" aria-hidden="true" tabindex="-1"></a>size_telecom1 <span class="ot">&lt;-</span> telecom1<span class="sc">$</span>size</span>
<span id="cb462-7"><a href="advanced-models.html#cb462-7" aria-hidden="true" tabindex="-1"></a>effort_telecom1 <span class="ot">&lt;-</span> telecom1<span class="sc">$</span>effort</span>
<span id="cb462-8"><a href="advanced-models.html#cb462-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-9"><a href="advanced-models.html#cb462-9" aria-hidden="true" tabindex="-1"></a>chinaTrain <span class="ot">&lt;-</span> <span class="fu">read.arff</span>(<span class="st">&quot;./datasets/effortEstimation/china3AttSelectedAFPTrain.arff&quot;</span>)</span>
<span id="cb462-10"><a href="advanced-models.html#cb462-10" aria-hidden="true" tabindex="-1"></a>china_train_size <span class="ot">&lt;-</span> chinaTrain<span class="sc">$</span>AFP </span>
<span id="cb462-11"><a href="advanced-models.html#cb462-11" aria-hidden="true" tabindex="-1"></a>china_train_effort <span class="ot">&lt;-</span> chinaTrain<span class="sc">$</span>Effort</span>
<span id="cb462-12"><a href="advanced-models.html#cb462-12" aria-hidden="true" tabindex="-1"></a>chinaTest <span class="ot">&lt;-</span> <span class="fu">read.arff</span>(<span class="st">&quot;./datasets/effortEstimation/china3AttSelectedAFPTest.arff&quot;</span>)</span>
<span id="cb462-13"><a href="advanced-models.html#cb462-13" aria-hidden="true" tabindex="-1"></a>china_size_test <span class="ot">&lt;-</span> chinaTest<span class="sc">$</span>AFP</span>
<span id="cb462-14"><a href="advanced-models.html#cb462-14" aria-hidden="true" tabindex="-1"></a>actualEffort <span class="ot">&lt;-</span> chinaTest<span class="sc">$</span>Effort</span></code></pre></div>
</div>
<div id="genetic-programming-for-symbolic-regression-china-dataset." class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Genetic Programming for Symbolic Regression: China dataset.</h3>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="advanced-models.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;rgp&quot;</span>)</span>
<span id="cb463-2"><a href="advanced-models.html#cb463-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">5</span>)</span>
<span id="cb463-3"><a href="advanced-models.html#cb463-3" aria-hidden="true" tabindex="-1"></a>stepsGenerations <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb463-4"><a href="advanced-models.html#cb463-4" aria-hidden="true" tabindex="-1"></a>initialPopulation <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb463-5"><a href="advanced-models.html#cb463-5" aria-hidden="true" tabindex="-1"></a>Steps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>)</span>
<span id="cb463-6"><a href="advanced-models.html#cb463-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> china_train_effort   <span class="co">#</span></span>
<span id="cb463-7"><a href="advanced-models.html#cb463-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> china_train_size  <span class="co"># </span></span>
<span id="cb463-8"><a href="advanced-models.html#cb463-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-9"><a href="advanced-models.html#cb463-9" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y, x)  <span class="co"># create a data frame with effort, size</span></span>
<span id="cb463-10"><a href="advanced-models.html#cb463-10" aria-hidden="true" tabindex="-1"></a><span class="co"># newFuncSet &lt;- mathFunctionSet</span></span>
<span id="cb463-11"><a href="advanced-models.html#cb463-11" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatives to mathFunctionSet</span></span>
<span id="cb463-12"><a href="advanced-models.html#cb463-12" aria-hidden="true" tabindex="-1"></a><span class="co"># newFuncSet &lt;- expLogFunctionSet # sqrt&quot;, &quot;exp&quot;, and &quot;ln&quot;</span></span>
<span id="cb463-13"><a href="advanced-models.html#cb463-13" aria-hidden="true" tabindex="-1"></a><span class="co"># newFuncSet &lt;- trigonometricFunctionSet</span></span>
<span id="cb463-14"><a href="advanced-models.html#cb463-14" aria-hidden="true" tabindex="-1"></a><span class="co"># newFuncSet &lt;- arithmeticFunctionSet</span></span>
<span id="cb463-15"><a href="advanced-models.html#cb463-15" aria-hidden="true" tabindex="-1"></a>newFuncSet <span class="ot">&lt;-</span> <span class="fu">functionSet</span>(<span class="st">&quot;+&quot;</span>,<span class="st">&quot;-&quot;</span>,<span class="st">&quot;*&quot;</span>, <span class="st">&quot;/&quot;</span>,<span class="st">&quot;sqrt&quot;</span>, <span class="st">&quot;log&quot;</span>, <span class="st">&quot;exp&quot;</span>) <span class="co"># ,, )</span></span>
<span id="cb463-16"><a href="advanced-models.html#cb463-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-17"><a href="advanced-models.html#cb463-17" aria-hidden="true" tabindex="-1"></a>gpresult <span class="ot">&lt;-</span> <span class="fu">symbolicRegression</span>(y <span class="sc">~</span> x, </span>
<span id="cb463-18"><a href="advanced-models.html#cb463-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">data=</span>data2, <span class="at">functionSet=</span>newFuncSet,</span>
<span id="cb463-19"><a href="advanced-models.html#cb463-19" aria-hidden="true" tabindex="-1"></a>                                <span class="at">populationSize=</span>initialPopulation,</span>
<span id="cb463-20"><a href="advanced-models.html#cb463-20" aria-hidden="true" tabindex="-1"></a>                                <span class="at">stopCondition=</span><span class="fu">makeStepsStopCondition</span>(stepsGenerations))</span>
<span id="cb463-21"><a href="advanced-models.html#cb463-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-22"><a href="advanced-models.html#cb463-22" aria-hidden="true" tabindex="-1"></a>bf <span class="ot">&lt;-</span> gpresult<span class="sc">$</span>population[[<span class="fu">which.min</span>(<span class="fu">sapply</span>(gpresult<span class="sc">$</span>population, gpresult<span class="sc">$</span>fitnessFunction))]]</span>
<span id="cb463-23"><a href="advanced-models.html#cb463-23" aria-hidden="true" tabindex="-1"></a>wf <span class="ot">&lt;-</span> gpresult<span class="sc">$</span>population[[<span class="fu">which.max</span>(<span class="fu">sapply</span>(gpresult<span class="sc">$</span>population, gpresult<span class="sc">$</span>fitnessFunction))]]</span>
<span id="cb463-24"><a href="advanced-models.html#cb463-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-25"><a href="advanced-models.html#cb463-25" aria-hidden="true" tabindex="-1"></a>bf1 <span class="ot">&lt;-</span> gpresult<span class="sc">$</span>population[[<span class="fu">which.min</span>((gpresult<span class="sc">$</span>fitnessValues))]]</span>
<span id="cb463-26"><a href="advanced-models.html#cb463-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb463-27"><a href="advanced-models.html#cb463-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">bf</span>(x), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb463-28"><a href="advanced-models.html#cb463-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">wf</span>(x), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb463-29"><a href="advanced-models.html#cb463-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb463-30"><a href="advanced-models.html#cb463-30" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> china_size_test</span>
<span id="cb463-31"><a href="advanced-models.html#cb463-31" aria-hidden="true" tabindex="-1"></a>estim_by_gp <span class="ot">&lt;-</span> <span class="fu">bf</span>(x_test)</span>
<span id="cb463-32"><a href="advanced-models.html#cb463-32" aria-hidden="true" tabindex="-1"></a>ae_gp <span class="ot">&lt;-</span> <span class="fu">abs</span>(actualEffort <span class="sc">-</span> estim_by_gp)</span>
<span id="cb463-33"><a href="advanced-models.html#cb463-33" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(ae_gp)</span></code></pre></div>
</div>
<div id="genetic-programming-for-symbolic-regression.-telecom1-dataset." class="section level3" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Genetic Programming for Symbolic Regression. Telecom1 dataset.</h3>
<ul>
<li>For illustration purposes only. We use all data points.</li>
</ul>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="advanced-models.html#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="co"># y &lt;- effort_telecom1   # all data points</span></span>
<span id="cb464-2"><a href="advanced-models.html#cb464-2" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- size_telecom1   # </span></span>
<span id="cb464-3"><a href="advanced-models.html#cb464-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb464-4"><a href="advanced-models.html#cb464-4" aria-hidden="true" tabindex="-1"></a><span class="co"># data2 &lt;- data.frame(y, x)  # create a data frame with effort, size</span></span>
<span id="cb464-5"><a href="advanced-models.html#cb464-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # newFuncSet &lt;- mathFunctionSet</span></span>
<span id="cb464-6"><a href="advanced-models.html#cb464-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # alternatives to mathFunctionSet</span></span>
<span id="cb464-7"><a href="advanced-models.html#cb464-7" aria-hidden="true" tabindex="-1"></a><span class="co"># newFuncSet &lt;- expLogFunctionSet # sqrt&quot;, &quot;exp&quot;, and &quot;ln&quot;</span></span>
<span id="cb464-8"><a href="advanced-models.html#cb464-8" aria-hidden="true" tabindex="-1"></a><span class="co"># # newFuncSet &lt;- trigonometricFunctionSet</span></span>
<span id="cb464-9"><a href="advanced-models.html#cb464-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # newFuncSet &lt;- arithmeticFunctionSet</span></span>
<span id="cb464-10"><a href="advanced-models.html#cb464-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # newFuncSet &lt;- functionSet(&quot;+&quot;,&quot;-&quot;,&quot;*&quot;, &quot;/&quot;,&quot;sqrt&quot;, &quot;log&quot;, &quot;exp&quot;) # ,, )</span></span>
<span id="cb464-11"><a href="advanced-models.html#cb464-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb464-12"><a href="advanced-models.html#cb464-12" aria-hidden="true" tabindex="-1"></a><span class="co"># gpresult &lt;- symbolicRegression(y ~ x, </span></span>
<span id="cb464-13"><a href="advanced-models.html#cb464-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 data=data2, functionSet=newFuncSet,</span></span>
<span id="cb464-14"><a href="advanced-models.html#cb464-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 populationSize=initialPopulation,</span></span>
<span id="cb464-15"><a href="advanced-models.html#cb464-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 stopCondition=makeStepsStopCondition(stepsGenerations))</span></span>
<span id="cb464-16"><a href="advanced-models.html#cb464-16" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb464-17"><a href="advanced-models.html#cb464-17" aria-hidden="true" tabindex="-1"></a><span class="co"># bf &lt;- gpresult$population[[which.min(sapply(gpresult$population, gpresult$fitnessFunction))]]</span></span>
<span id="cb464-18"><a href="advanced-models.html#cb464-18" aria-hidden="true" tabindex="-1"></a><span class="co"># wf &lt;- gpresult$population[[which.max(sapply(gpresult$population, gpresult$fitnessFunction))]]</span></span>
<span id="cb464-19"><a href="advanced-models.html#cb464-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb464-20"><a href="advanced-models.html#cb464-20" aria-hidden="true" tabindex="-1"></a><span class="co"># bf1 &lt;- gpresult$population[[which.min((gpresult$fitnessValues))]]</span></span>
<span id="cb464-21"><a href="advanced-models.html#cb464-21" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(x,y)</span></span>
<span id="cb464-22"><a href="advanced-models.html#cb464-22" aria-hidden="true" tabindex="-1"></a><span class="co"># lines(x, bf(x), type = &quot;l&quot;, col=&quot;blue&quot;, lwd=3)</span></span>
<span id="cb464-23"><a href="advanced-models.html#cb464-23" aria-hidden="true" tabindex="-1"></a><span class="co"># lines(x,wf(x), type = &quot;l&quot;, col=&quot;red&quot;, lwd=2)</span></span></code></pre></div>
</div>
</div>
<div id="neural-networks" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Neural Networks</h2>
<p>A neural network (NN) simulates some of the learning functions of the human brain.</p>
<p>It can recognize patterns and “learn” . Through the use of a trial and error method the system “learns” to become an “expert” in the field.</p>
<p>A NN is composed of a set of nodes (units, neurons, processing elements)
+ Each node has input and output
+ Each node performs a simple computation by its node function</p>
<p>Weighted connections between nodes
+ Connectivity gives the structure/architecture of the net
+ What can be computed by a NN is primarily determined by the connections and their weights</p>
<p><img src="figures/neuralnet.png" />
<img src="figures/neuralnet2.png" /></p>
<p>There are several packages in R to work with NNs
+ <a href="https://cran.r-project.org/web/packages/neuralnet/index.html">neuralnet</a>
+ <a href="https://cran.r-project.org/web/packages/nnet/index.html">nnet</a>
+ <a href="https://cran.r-project.org/web/packages/RSNNS/index.html">RSNNS</a></p>
<p>TO BE FIXED!!!: The following is an example with the neuralnet package (TO DO, denormalize!). Neural nets need scaling of variables to work properly.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="advanced-models.html#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb465-2"><a href="advanced-models.html#cb465-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(neuralnet)</span>
<span id="cb465-3"><a href="advanced-models.html#cb465-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-4"><a href="advanced-models.html#cb465-4" aria-hidden="true" tabindex="-1"></a>chinaTrain <span class="ot">&lt;-</span> <span class="fu">read.arff</span>(<span class="st">&quot;datasets/effortEstimation/china3AttSelectedAFPTrain.arff&quot;</span>)</span>
<span id="cb465-5"><a href="advanced-models.html#cb465-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-6"><a href="advanced-models.html#cb465-6" aria-hidden="true" tabindex="-1"></a>afpsize <span class="ot">&lt;-</span> chinaTrain<span class="sc">$</span>AFP</span>
<span id="cb465-7"><a href="advanced-models.html#cb465-7" aria-hidden="true" tabindex="-1"></a>effort_china <span class="ot">&lt;-</span> chinaTrain<span class="sc">$</span>Effort</span>
<span id="cb465-8"><a href="advanced-models.html#cb465-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-9"><a href="advanced-models.html#cb465-9" aria-hidden="true" tabindex="-1"></a>chinaTest <span class="ot">&lt;-</span> <span class="fu">read.arff</span>(<span class="st">&quot;datasets/effortEstimation/china3AttSelectedAFPTest.arff&quot;</span>)</span>
<span id="cb465-10"><a href="advanced-models.html#cb465-10" aria-hidden="true" tabindex="-1"></a>AFPTest <span class="ot">&lt;-</span> chinaTest<span class="sc">$</span>AFP</span>
<span id="cb465-11"><a href="advanced-models.html#cb465-11" aria-hidden="true" tabindex="-1"></a>actualEffort <span class="ot">&lt;-</span> chinaTest<span class="sc">$</span>Effort</span>
<span id="cb465-12"><a href="advanced-models.html#cb465-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-13"><a href="advanced-models.html#cb465-13" aria-hidden="true" tabindex="-1"></a>trainingdata <span class="ot">&lt;-</span> <span class="fu">cbind</span>(afpsize,effort_china)</span>
<span id="cb465-14"><a href="advanced-models.html#cb465-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(trainingdata) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Input&quot;</span>,<span class="st">&quot;Output&quot;</span>)</span>
<span id="cb465-15"><a href="advanced-models.html#cb465-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-16"><a href="advanced-models.html#cb465-16" aria-hidden="true" tabindex="-1"></a>testingdata <span class="ot">&lt;-</span> <span class="fu">cbind</span>(afpsize,effort_china)</span>
<span id="cb465-17"><a href="advanced-models.html#cb465-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(trainingdata) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Input&quot;</span>,<span class="st">&quot;Output&quot;</span>)</span>
<span id="cb465-18"><a href="advanced-models.html#cb465-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-19"><a href="advanced-models.html#cb465-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Normalize data</span></span>
<span id="cb465-20"><a href="advanced-models.html#cb465-20" aria-hidden="true" tabindex="-1"></a>norm.fun <span class="ot">=</span> <span class="cf">function</span>(x){(x <span class="sc">-</span> <span class="fu">min</span>(x))<span class="sc">/</span>(<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))}</span>
<span id="cb465-21"><a href="advanced-models.html#cb465-21" aria-hidden="true" tabindex="-1"></a>data.norm <span class="ot">=</span> <span class="fu">apply</span>(trainingdata, <span class="dv">2</span>, norm.fun)</span>
<span id="cb465-22"><a href="advanced-models.html#cb465-22" aria-hidden="true" tabindex="-1"></a><span class="co">#data.norm</span></span>
<span id="cb465-23"><a href="advanced-models.html#cb465-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-24"><a href="advanced-models.html#cb465-24" aria-hidden="true" tabindex="-1"></a>testdata.norm <span class="ot">&lt;-</span> <span class="fu">apply</span>(trainingdata, <span class="dv">2</span>, norm.fun)</span>
<span id="cb465-25"><a href="advanced-models.html#cb465-25" aria-hidden="true" tabindex="-1"></a><span class="co">#testdata.norm</span></span>
<span id="cb465-26"><a href="advanced-models.html#cb465-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-27"><a href="advanced-models.html#cb465-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-28"><a href="advanced-models.html#cb465-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Train the neural network</span></span>
<span id="cb465-29"><a href="advanced-models.html#cb465-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Going to have 10 hidden layers</span></span>
<span id="cb465-30"><a href="advanced-models.html#cb465-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Threshold is a numeric value specifying the threshold for the partial</span></span>
<span id="cb465-31"><a href="advanced-models.html#cb465-31" aria-hidden="true" tabindex="-1"></a><span class="co">#derivatives of the error function as stopping criteria.</span></span>
<span id="cb465-32"><a href="advanced-models.html#cb465-32" aria-hidden="true" tabindex="-1"></a><span class="co">#net_eff &lt;- neuralnet(Output~Input,trainingdata, hidden=5, threshold=0.25)</span></span>
<span id="cb465-33"><a href="advanced-models.html#cb465-33" aria-hidden="true" tabindex="-1"></a>net_eff <span class="ot">&lt;-</span> <span class="fu">neuralnet</span>(Output<span class="sc">~</span>Input, data.norm, <span class="at">hidden=</span><span class="dv">10</span>, <span class="at">threshold=</span><span class="fl">0.01</span>)</span>
<span id="cb465-34"><a href="advanced-models.html#cb465-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-35"><a href="advanced-models.html#cb465-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the network</span></span>
<span id="cb465-36"><a href="advanced-models.html#cb465-36" aria-hidden="true" tabindex="-1"></a><span class="co"># print(net_eff)</span></span>
<span id="cb465-37"><a href="advanced-models.html#cb465-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-38"><a href="advanced-models.html#cb465-38" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the neural network</span></span>
<span id="cb465-39"><a href="advanced-models.html#cb465-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(net_eff)</span>
<span id="cb465-40"><a href="advanced-models.html#cb465-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-41"><a href="advanced-models.html#cb465-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Test the neural network on some training data</span></span>
<span id="cb465-42"><a href="advanced-models.html#cb465-42" aria-hidden="true" tabindex="-1"></a><span class="co">#testdata.norm&lt;-data.frame((testdata[,1] - min(data[, &#39;displ&#39;]))/(max(data[, &#39;displ&#39;])-min(data[, &#39;displ&#39;])),(testdata[,2] - min(data[, &#39;year&#39;]))/(max(data[, &#39;year&#39;])-min(data[, &#39;year&#39;])),(testdata[,3] - min(data[, &#39;cyl&#39;]))/(max(data[, &#39;cyl&#39;])-min(data[, &#39;cyl&#39;])),(testdata[,4] - min(data[, &#39;hwy&#39;]))/(max(data[, &#39;hwy&#39;])-min(data[, &#39;hwy&#39;])))</span></span>
<span id="cb465-43"><a href="advanced-models.html#cb465-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-44"><a href="advanced-models.html#cb465-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Run them through the neural network</span></span>
<span id="cb465-45"><a href="advanced-models.html#cb465-45" aria-hidden="true" tabindex="-1"></a><span class="co"># net.results &lt;- compute(net_eff, testdata.norm[,2]) </span></span>
<span id="cb465-46"><a href="advanced-models.html#cb465-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-47"><a href="advanced-models.html#cb465-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-48"><a href="advanced-models.html#cb465-48" aria-hidden="true" tabindex="-1"></a><span class="co">#net.results &lt;- compute(net_eff, dataTest.norm) # With normalized data</span></span>
<span id="cb465-49"><a href="advanced-models.html#cb465-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-50"><a href="advanced-models.html#cb465-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets see what properties net.sqrt has</span></span>
<span id="cb465-51"><a href="advanced-models.html#cb465-51" aria-hidden="true" tabindex="-1"></a><span class="co">#ls(net.results)</span></span>
<span id="cb465-52"><a href="advanced-models.html#cb465-52" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets see the results</span></span>
<span id="cb465-53"><a href="advanced-models.html#cb465-53" aria-hidden="true" tabindex="-1"></a><span class="co">#print(net.results$net.result)</span></span>
<span id="cb465-54"><a href="advanced-models.html#cb465-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-55"><a href="advanced-models.html#cb465-55" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets display a better version of the results</span></span>
<span id="cb465-56"><a href="advanced-models.html#cb465-56" aria-hidden="true" tabindex="-1"></a><span class="co">#cleanoutput &lt;- cbind(testdata.norm[,2],actualEffort,</span></span>
<span id="cb465-57"><a href="advanced-models.html#cb465-57" aria-hidden="true" tabindex="-1"></a><span class="co">#                     as.data.frame(net.results$net.result))</span></span>
<span id="cb465-58"><a href="advanced-models.html#cb465-58" aria-hidden="true" tabindex="-1"></a><span class="co">#colnames(cleanoutput) &lt;- c(&quot;Input&quot;,&quot;Expected Output&quot;,&quot;Neural Net Output&quot;)</span></span>
<span id="cb465-59"><a href="advanced-models.html#cb465-59" aria-hidden="true" tabindex="-1"></a><span class="co">#print(cleanoutput)</span></span></code></pre></div>
</div>
<div id="support-vector-machines" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Support Vector Machines</h2>
<p>SVM</p>
</div>
<div id="ensembles" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Ensembles</h2>
<p>Ensembles or meta-learners combine multiple models to obtain better predictions i.e., this technique consists in combining single classifiers (sometimes are also called weak classifiers).</p>
<p>A problem with ensembles is that their models are difficult to interpret (they behave as blackboxes) in comparison to
decision trees or rules which provide an explanation of their
decision making process.</p>
<p>They are typically classified as Bagging, Boosting and Stacking (Stacked generalization).</p>
<div id="bagging" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Bagging</h3>
<p>Bagging (also known as Bootstrap aggregating) is an ensemble technique in which a base learner is applied to multiple equal size datasets created from the original data using bootstraping. Predictions are based on voting of the individual predictions. An advantage of bagging is that it does not require any modification to the learning algorithm and takes advantage of the instability of the base classifier to create diversity among individual ensembles so that individual members of the ensemble perform well in different regions of the data. Bagging does not perform well with classifiers if their output is robust to perturbation of the data such as
nearest-neighbour (NN) classifiers.</p>
</div>
<div id="boosting" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Boosting</h3>
<p>Boosting techniques generate multiple models that complement each other inducing models that improve regions of the data where previous induced models preformed poorly. This is achieved by increasing the weights of instances wrongly classified, so new learners focus on those instances. Finally, classification is based on a weighted voted among all members of the ensemble.</p>
<p>In particular, AdaBoost.M1 [15] is a popular boosting algorithm for classification. The set of training examples is assigned an equal weight at the beginning and the weight of instances is either increased or
decreased depending on whether the learner classified that instance incorrectly or not. The following iterations focus on those instances with higher weights. AdaBoost.M1 can be applied to any base learner.</p>
</div>
<div id="rotation-forests" class="section level3" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Rotation Forests</h3>
<p>Rotation Forests [40] combine randomly chosen subsets of attributes (random subspaces) and bagging approaches with principal components feature generation to construct an ensemble of decision trees. Principal Component Analysis is used as a feature selection technique combining subsets of
attributes which are used with a bootstrapped subset of the training data by the base classifier.</p>
</div>
<div id="boosting-in-r" class="section level3" number="6.5.4">
<h3><span class="header-section-number">6.5.4</span> Boosting in R</h3>
<p>In R, there are three packages to deal with Boosting: gmb, ada and the mboost packages. An example of gbm using the caret package.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="advanced-models.html#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries</span></span>
<span id="cb466-2"><a href="advanced-models.html#cb466-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb466-3"><a href="advanced-models.html#cb466-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb466-4"><a href="advanced-models.html#cb466-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb466-5"><a href="advanced-models.html#cb466-5" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb466-6"><a href="advanced-models.html#cb466-6" aria-hidden="true" tabindex="-1"></a><span class="co"># model it</span></span>
<span id="cb466-7"><a href="advanced-models.html#cb466-7" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb466-8"><a href="advanced-models.html#cb466-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb466-9"><a href="advanced-models.html#cb466-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get names of caret supported models (just a few - head)</span></span>
<span id="cb466-10"><a href="advanced-models.html#cb466-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">names</span>(<span class="fu">getModelInfo</span>()))</span></code></pre></div>
<pre><code>## [1] &quot;ada&quot;         &quot;AdaBag&quot;      &quot;AdaBoost.M1&quot; &quot;adaboost&quot;    &quot;amdai&quot;      
## [6] &quot;ANFIS&quot;</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="advanced-models.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show model info and find out what type of model it is</span></span>
<span id="cb468-2"><a href="advanced-models.html#cb468-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getModelInfo</span>()<span class="sc">$</span>gbm<span class="sc">$</span>tags</span></code></pre></div>
<pre><code>## [1] &quot;Tree-Based Model&quot;           &quot;Boosting&quot;                  
## [3] &quot;Ensemble Model&quot;             &quot;Implicit Feature Selection&quot;
## [5] &quot;Accepts Case Weights&quot;</code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="advanced-models.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getModelInfo</span>()<span class="sc">$</span>gbm<span class="sc">$</span>type</span></code></pre></div>
<pre><code>## [1] &quot;Regression&quot;     &quot;Classification&quot;</code></pre>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="advanced-models.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb472-2"><a href="advanced-models.html#cb472-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb472-3"><a href="advanced-models.html#cb472-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb472-4"><a href="advanced-models.html#cb472-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-5"><a href="advanced-models.html#cb472-5" aria-hidden="true" tabindex="-1"></a>kc1 <span class="ot">&lt;-</span> <span class="fu">read.arff</span>(<span class="st">&quot;./datasets/defectPred/D1/KC1.arff&quot;</span>)</span>
<span id="cb472-6"><a href="advanced-models.html#cb472-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-7"><a href="advanced-models.html#cb472-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data into training and test datasets</span></span>
<span id="cb472-8"><a href="advanced-models.html#cb472-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Improve this with createDataParticion from Caret</span></span>
<span id="cb472-9"><a href="advanced-models.html#cb472-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb472-10"><a href="advanced-models.html#cb472-10" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(kc1), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>))</span>
<span id="cb472-11"><a href="advanced-models.html#cb472-11" aria-hidden="true" tabindex="-1"></a>kc1.train <span class="ot">&lt;-</span> kc1[ind<span class="sc">==</span><span class="dv">1</span>, ]</span>
<span id="cb472-12"><a href="advanced-models.html#cb472-12" aria-hidden="true" tabindex="-1"></a>kc1.test <span class="ot">&lt;-</span> kc1[ind<span class="sc">==</span><span class="dv">2</span>, ]</span>
<span id="cb472-13"><a href="advanced-models.html#cb472-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-14"><a href="advanced-models.html#cb472-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-15"><a href="advanced-models.html#cb472-15" aria-hidden="true" tabindex="-1"></a><span class="co"># create caret trainControl object to control the number of cross-validations performed</span></span>
<span id="cb472-16"><a href="advanced-models.html#cb472-16" aria-hidden="true" tabindex="-1"></a>objControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">&#39;cv&#39;</span>, <span class="at">number=</span><span class="dv">3</span>, <span class="at">returnResamp=</span><span class="st">&#39;none&#39;</span>, <span class="at">summaryFunction =</span> twoClassSummary, <span class="at">classProbs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb472-17"><a href="advanced-models.html#cb472-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-18"><a href="advanced-models.html#cb472-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-19"><a href="advanced-models.html#cb472-19" aria-hidden="true" tabindex="-1"></a><span class="co"># run model</span></span>
<span id="cb472-20"><a href="advanced-models.html#cb472-20" aria-hidden="true" tabindex="-1"></a>objModel <span class="ot">&lt;-</span> <span class="fu">train</span>(Defective <span class="sc">~</span> .,</span>
<span id="cb472-21"><a href="advanced-models.html#cb472-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> kc1.train,</span>
<span id="cb472-22"><a href="advanced-models.html#cb472-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&#39;gbm&#39;</span>, </span>
<span id="cb472-23"><a href="advanced-models.html#cb472-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> objControl,  </span>
<span id="cb472-24"><a href="advanced-models.html#cb472-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">&quot;ROC&quot;</span> <span class="co">#,</span></span>
<span id="cb472-25"><a href="advanced-models.html#cb472-25" aria-hidden="true" tabindex="-1"></a>                  <span class="co">#preProc = c(&quot;center&quot;, &quot;scale&quot;)</span></span>
<span id="cb472-26"><a href="advanced-models.html#cb472-26" aria-hidden="true" tabindex="-1"></a>                  )</span></code></pre></div>
<pre><code>## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        0.8395            -nan     0.1000    0.0121
##      2        0.8125            -nan     0.1000    0.0122
##      3        0.7898            -nan     0.1000    0.0085
##      4        0.7698            -nan     0.1000    0.0072
##      5        0.7568            -nan     0.1000    0.0057
##      6        0.7477            -nan     0.1000    0.0048
##      7        0.7414            -nan     0.1000    0.0012
##      8        0.7354            -nan     0.1000    0.0018
##      9        0.7297            -nan     0.1000    0.0021
##     10        0.7259            -nan     0.1000    0.0004
##     20        0.6798            -nan     0.1000    0.0011
##     40        0.6539            -nan     0.1000    0.0004
##     60        0.6409            -nan     0.1000   -0.0008
##     80        0.6314            -nan     0.1000   -0.0005
##    100        0.6228            -nan     0.1000   -0.0008
##    120        0.6129            -nan     0.1000   -0.0004
##    140        0.6054            -nan     0.1000   -0.0002
##    150        0.6027            -nan     0.1000   -0.0014
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        0.8274            -nan     0.1000    0.0181
##      2        0.7993            -nan     0.1000    0.0085
##      3        0.7788            -nan     0.1000    0.0068
##      4        0.7534            -nan     0.1000    0.0073
##      5        0.7411            -nan     0.1000    0.0064
##      6        0.7307            -nan     0.1000    0.0023
##      7        0.7179            -nan     0.1000    0.0042
##      8        0.7090            -nan     0.1000    0.0030
##      9        0.7003            -nan     0.1000    0.0019
##     10        0.6883            -nan     0.1000    0.0038
##     20        0.6319            -nan     0.1000    0.0013
##     40        0.5943            -nan     0.1000   -0.0005
##     60        0.5686            -nan     0.1000   -0.0007
##     80        0.5471            -nan     0.1000   -0.0004
##    100        0.5339            -nan     0.1000   -0.0003
##    120        0.5164            -nan     0.1000   -0.0007
##    140        0.5031            -nan     0.1000   -0.0003
##    150        0.4959            -nan     0.1000   -0.0004
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        0.8276            -nan     0.1000    0.0191
##      2        0.7982            -nan     0.1000    0.0080
##      3        0.7726            -nan     0.1000    0.0088
##      4        0.7516            -nan     0.1000    0.0060
##      5        0.7286            -nan     0.1000    0.0102
##      6        0.7114            -nan     0.1000    0.0076
##      7        0.6994            -nan     0.1000    0.0029
##      8        0.6901            -nan     0.1000    0.0032
##      9        0.6769            -nan     0.1000    0.0052
##     10        0.6693            -nan     0.1000    0.0009
##     20        0.6233            -nan     0.1000   -0.0015
##     40        0.5712            -nan     0.1000   -0.0007
##     60        0.5373            -nan     0.1000    0.0009
##     80        0.5079            -nan     0.1000   -0.0010
##    100        0.4864            -nan     0.1000   -0.0008
##    120        0.4654            -nan     0.1000   -0.0007
##    140        0.4444            -nan     0.1000   -0.0009
##    150        0.4324            -nan     0.1000   -0.0001
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        0.8396            -nan     0.1000    0.0109
##      2        0.8169            -nan     0.1000    0.0084
##      3        0.7981            -nan     0.1000    0.0065
##      4        0.7839            -nan     0.1000    0.0051
##      5        0.7743            -nan     0.1000    0.0037
##      6        0.7665            -nan     0.1000    0.0025
##      7        0.7540            -nan     0.1000    0.0050
##      8        0.7452            -nan     0.1000    0.0045
##      9        0.7393            -nan     0.1000    0.0024
##     10        0.7329            -nan     0.1000    0.0021
##     20        0.6974            -nan     0.1000    0.0011
##     40        0.6736            -nan     0.1000   -0.0011
##     60        0.6574            -nan     0.1000   -0.0008
##     80        0.6460            -nan     0.1000   -0.0001
##    100        0.6348            -nan     0.1000    0.0005
##    120        0.6258            -nan     0.1000   -0.0003
##    140        0.6159            -nan     0.1000   -0.0000
##    150        0.6120            -nan     0.1000   -0.0003
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        0.8351            -nan     0.1000    0.0163
##      2        0.8086            -nan     0.1000    0.0111
##      3        0.7881            -nan     0.1000    0.0106
##      4        0.7709            -nan     0.1000    0.0074
##      5        0.7576            -nan     0.1000    0.0060
##      6        0.7454            -nan     0.1000    0.0047
##      7        0.7349            -nan     0.1000    0.0047
##      8        0.7303            -nan     0.1000    0.0009
##      9        0.7212            -nan     0.1000    0.0028
##     10        0.7147            -nan     0.1000    0.0011
##     20        0.6731            -nan     0.1000   -0.0008
##     40        0.6194            -nan     0.1000   -0.0002
##     60        0.5928            -nan     0.1000   -0.0012
##     80        0.5713            -nan     0.1000   -0.0002
##    100        0.5540            -nan     0.1000   -0.0009
##    120        0.5374            -nan     0.1000   -0.0006
##    140        0.5247            -nan     0.1000   -0.0009
##    150        0.5169            -nan     0.1000   -0.0003
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        0.8275            -nan     0.1000    0.0158
##      2        0.8018            -nan     0.1000    0.0124
##      3        0.7813            -nan     0.1000    0.0094
##      4        0.7602            -nan     0.1000    0.0077
##      5        0.7446            -nan     0.1000    0.0038
##      6        0.7322            -nan     0.1000    0.0028
##      7        0.7218            -nan     0.1000    0.0023
##      8        0.7100            -nan     0.1000    0.0030
##      9        0.6981            -nan     0.1000    0.0038
##     10        0.6911            -nan     0.1000    0.0017
##     20        0.6455            -nan     0.1000   -0.0013
##     40        0.5885            -nan     0.1000   -0.0010
##     60        0.5562            -nan     0.1000   -0.0008
##     80        0.5251            -nan     0.1000   -0.0012
##    100        0.4970            -nan     0.1000   -0.0001
##    120        0.4705            -nan     0.1000   -0.0009
##    140        0.4522            -nan     0.1000   -0.0009
##    150        0.4433            -nan     0.1000   -0.0012
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        0.8394            -nan     0.1000    0.0118
##      2        0.8188            -nan     0.1000    0.0072
##      3        0.7986            -nan     0.1000    0.0065
##      4        0.7875            -nan     0.1000    0.0038
##      5        0.7759            -nan     0.1000    0.0012
##      6        0.7731            -nan     0.1000   -0.0002
##      7        0.7589            -nan     0.1000    0.0048
##      8        0.7511            -nan     0.1000    0.0029
##      9        0.7471            -nan     0.1000    0.0015
##     10        0.7381            -nan     0.1000    0.0041
##     20        0.7008            -nan     0.1000    0.0002
##     40        0.6788            -nan     0.1000   -0.0009
##     60        0.6652            -nan     0.1000   -0.0001
##     80        0.6550            -nan     0.1000   -0.0003
##    100        0.6453            -nan     0.1000   -0.0007
##    120        0.6399            -nan     0.1000   -0.0012
##    140        0.6335            -nan     0.1000    0.0000
##    150        0.6315            -nan     0.1000   -0.0003
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        0.8354            -nan     0.1000    0.0150
##      2        0.8132            -nan     0.1000    0.0093
##      3        0.7961            -nan     0.1000    0.0045
##      4        0.7781            -nan     0.1000    0.0082
##      5        0.7684            -nan     0.1000    0.0040
##      6        0.7528            -nan     0.1000    0.0057
##      7        0.7415            -nan     0.1000    0.0042
##      8        0.7334            -nan     0.1000    0.0038
##      9        0.7255            -nan     0.1000    0.0003
##     10        0.7150            -nan     0.1000    0.0026
##     20        0.6734            -nan     0.1000    0.0005
##     40        0.6304            -nan     0.1000   -0.0001
##     60        0.6008            -nan     0.1000   -0.0003
##     80        0.5804            -nan     0.1000   -0.0011
##    100        0.5621            -nan     0.1000   -0.0001
##    120        0.5404            -nan     0.1000   -0.0006
##    140        0.5303            -nan     0.1000   -0.0012
##    150        0.5231            -nan     0.1000   -0.0008
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        0.8381            -nan     0.1000    0.0104
##      2        0.8087            -nan     0.1000    0.0090
##      3        0.7875            -nan     0.1000    0.0045
##      4        0.7677            -nan     0.1000    0.0085
##      5        0.7504            -nan     0.1000    0.0063
##      6        0.7400            -nan     0.1000    0.0023
##      7        0.7307            -nan     0.1000    0.0008
##      8        0.7172            -nan     0.1000    0.0045
##      9        0.7089            -nan     0.1000    0.0022
##     10        0.6994            -nan     0.1000    0.0034
##     20        0.6439            -nan     0.1000    0.0003
##     40        0.5957            -nan     0.1000   -0.0005
##     60        0.5590            -nan     0.1000   -0.0001
##     80        0.5348            -nan     0.1000   -0.0004
##    100        0.5080            -nan     0.1000   -0.0014
##    120        0.4793            -nan     0.1000   -0.0009
##    140        0.4563            -nan     0.1000   -0.0016
##    150        0.4475            -nan     0.1000   -0.0006
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        0.8374            -nan     0.1000    0.0124
##      2        0.8182            -nan     0.1000    0.0086
##      3        0.8004            -nan     0.1000    0.0083
##      4        0.7852            -nan     0.1000    0.0060
##      5        0.7742            -nan     0.1000    0.0036
##      6        0.7620            -nan     0.1000    0.0048
##      7        0.7528            -nan     0.1000    0.0047
##      8        0.7464            -nan     0.1000    0.0026
##      9        0.7441            -nan     0.1000   -0.0001
##     10        0.7362            -nan     0.1000    0.0034
##     20        0.7017            -nan     0.1000    0.0015
##     40        0.6737            -nan     0.1000    0.0000
##     60        0.6611            -nan     0.1000   -0.0004
##     80        0.6530            -nan     0.1000   -0.0001
##    100        0.6468            -nan     0.1000   -0.0002
##    120        0.6410            -nan     0.1000   -0.0004
##    140        0.6335            -nan     0.1000   -0.0000
##    150        0.6312            -nan     0.1000   -0.0003</code></pre>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="advanced-models.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out variable importance</span></span>
<span id="cb474-2"><a href="advanced-models.html#cb474-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(objModel)</span></code></pre></div>
<p><img src="DASE_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<pre><code>##                                         var rel.inf
## NUM_OPERANDS                   NUM_OPERANDS   14.28
## HALSTEAD_CONTENT           HALSTEAD_CONTENT   12.88
## HALSTEAD_DIFFICULTY     HALSTEAD_DIFFICULTY   12.45
## HALSTEAD_VOLUME             HALSTEAD_VOLUME    9.38
## LOC_COMMENTS                   LOC_COMMENTS    6.03
## NUM_UNIQUE_OPERATORS   NUM_UNIQUE_OPERATORS    5.77
## NUM_UNIQUE_OPERANDS     NUM_UNIQUE_OPERANDS    5.32
## LOC_CODE_AND_COMMENT   LOC_CODE_AND_COMMENT    4.64
## HALSTEAD_EFFORT             HALSTEAD_EFFORT    4.45
## LOC_EXECUTABLE               LOC_EXECUTABLE    4.08
## LOC_BLANK                         LOC_BLANK    3.74
## CYCLOMATIC_COMPLEXITY CYCLOMATIC_COMPLEXITY    3.65
## ESSENTIAL_COMPLEXITY   ESSENTIAL_COMPLEXITY    3.41
## LOC_TOTAL                         LOC_TOTAL    3.00
## HALSTEAD_LENGTH             HALSTEAD_LENGTH    2.15
## NUM_OPERATORS                 NUM_OPERATORS    1.67
## BRANCH_COUNT                   BRANCH_COUNT    1.59
## DESIGN_COMPLEXITY         DESIGN_COMPLEXITY    1.52
## HALSTEAD_ERROR_EST       HALSTEAD_ERROR_EST    0.00
## HALSTEAD_LEVEL               HALSTEAD_LEVEL    0.00
## HALSTEAD_PROG_TIME       HALSTEAD_PROG_TIME    0.00</code></pre>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="advanced-models.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find out model details</span></span>
<span id="cb476-2"><a href="advanced-models.html#cb476-2" aria-hidden="true" tabindex="-1"></a>objModel</span></code></pre></div>
<pre><code>## Stochastic Gradient Boosting 
## 
## 1500 samples
##   21 predictor
##    2 classes: &#39;N&#39;, &#39;Y&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (3 fold) 
## Summary of sample sizes: 1000, 1000, 1000 
## Resampling results across tuning parameters:
## 
##   interaction.depth  n.trees  ROC    Sens   Spec 
##   1                   50      0.803  0.978  0.145
##   1                  100      0.809  0.982  0.171
##   1                  150      0.814  0.982  0.179
##   2                   50      0.807  0.979  0.167
##   2                  100      0.805  0.976  0.222
##   2                  150      0.801  0.966  0.269
##   3                   50      0.808  0.968  0.179
##   3                  100      0.809  0.961  0.209
##   3                  150      0.803  0.957  0.278
## 
## Tuning parameter &#39;shrinkage&#39; was held constant at a value of 0.1
## 
## Tuning parameter &#39;n.minobsinnode&#39; was held constant at a value of 10
## ROC was used to select the optimal model using the largest value.
## The final values used for the model were n.trees = 150, interaction.depth =
##  1, shrinkage = 0.1 and n.minobsinnode = 10.</code></pre>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="advanced-models.html#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb478-2"><a href="advanced-models.html#cb478-2" aria-hidden="true" tabindex="-1"></a><span class="co"># evalutate model</span></span>
<span id="cb478-3"><a href="advanced-models.html#cb478-3" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb478-4"><a href="advanced-models.html#cb478-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get predictions on your testing data</span></span>
<span id="cb478-5"><a href="advanced-models.html#cb478-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-6"><a href="advanced-models.html#cb478-6" aria-hidden="true" tabindex="-1"></a><span class="co"># class prediction</span></span>
<span id="cb478-7"><a href="advanced-models.html#cb478-7" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object=</span>objModel, kc1.test[,<span class="sc">-</span><span class="dv">22</span>], <span class="at">type=</span><span class="st">&#39;raw&#39;</span>)</span>
<span id="cb478-8"><a href="advanced-models.html#cb478-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predictions)</span></code></pre></div>
<pre><code>## [1] N N N N N N
## Levels: N Y</code></pre>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="advanced-models.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">postResample</span>(<span class="at">pred=</span>predictions, <span class="at">obs=</span><span class="fu">as.factor</span>(kc1.test[,<span class="dv">22</span>]))</span></code></pre></div>
<pre><code>## Accuracy    Kappa 
##    0.864    0.228</code></pre>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="advanced-models.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities </span></span>
<span id="cb482-2"><a href="advanced-models.html#cb482-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object=</span>objModel, kc1.test[,<span class="sc">-</span><span class="dv">22</span>], <span class="at">type=</span><span class="st">&#39;prob&#39;</span>)</span>
<span id="cb482-3"><a href="advanced-models.html#cb482-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(predictions)</span></code></pre></div>
<pre><code>##       N      Y
## 1 0.920 0.0800
## 2 0.961 0.0395
## 3 0.840 0.1604
## 4 0.752 0.2484
## 5 0.825 0.1749
## 6 0.933 0.0670</code></pre>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="advanced-models.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="fu">postResample</span>(<span class="at">pred=</span>predictions[[<span class="dv">2</span>]], <span class="at">obs=</span><span class="fu">ifelse</span>(kc1.test[,<span class="dv">22</span>]<span class="sc">==</span><span class="st">&#39;yes&#39;</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span></code></pre></div>
<pre><code>##     RMSE Rsquared      MAE 
##    0.205       NA    0.140</code></pre>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="advanced-models.html#cb486-1" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="fu">ifelse</span>(kc1.test[,<span class="dv">22</span>]<span class="sc">==</span><span class="st">&quot;Y&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>), predictions[[<span class="dv">2</span>]])</span></code></pre></div>
<pre><code>## Setting levels: control = 0, case = 1</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="advanced-models.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(auc<span class="sc">$</span>auc)</span></code></pre></div>
<pre><code>## Area under the curve: 0.792</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="feature-selection-example.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="further-classification-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/danrodgar/dasedown/edit/master/510_advancedModelBuilding.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DASE.pdf", "DASE.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
